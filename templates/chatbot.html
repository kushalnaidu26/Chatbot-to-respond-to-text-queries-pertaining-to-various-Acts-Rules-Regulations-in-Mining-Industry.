{% extends "base.html" %}
{% block content %}
<div class="chat-container">
    <form method="POST">
        <textarea name="query" id="chat-input" placeholder="{% if language == 'english' %}Ask your question here...{% elif language == 'hindi' %}‡§Ö‡§™‡§®‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§Ø‡§π‡§æ‡§Å ‡§™‡•Ç‡§õ‡•á‡§Ç...{% elif language == 'telugu' %}‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞® ‡∞Ö‡∞°‡∞ó‡∞Ç‡∞°‡∞ø...{% elif language == 'kannada' %}‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≥ç‡≤∞‡≤∂‡≥ç‡≤®‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤ï‡≥á‡≤≥‡≤ø...{% endif %}" required></textarea><br>
        <button type="submit">
            {% if language == 'english' %}Send{% elif language == 'hindi' %}‡§≠‡•á‡§ú‡•á‡§Ç{% elif language == 'telugu' %}‡∞™‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø{% elif language == 'kannada' %}‡≤ï‡≤≥‡≥Å‡≤π‡≤ø‡≤∏‡≤ø{% endif %}
        </button>
    </form>

    <button onclick="startVoiceInput()">üé§ Voice Input</button>

    {% if response %}
    <div class="chat-response">
        <h3>
            {% if language == 'english' %}Response{% elif language == 'hindi' %}‡§â‡§§‡•ç‡§§‡§∞{% elif language == 'telugu' %}‡∞∏‡±ç‡∞™‡∞Ç‡∞¶‡∞®{% elif language == 'kannada' %}‡≤™‡≥ç‡≤∞‡≤§‡≤ø‡≤ï‡≥ç‡≤∞‡≤ø‡≤Ø‡≥Ü{% endif %}:
        </h3>
        <p>{{ response }}</p>
    </div>

    <button onclick="speakResponse(`{{ response | safe }}`)">üîä Speak Response</button>

    <div class="feedback-section" style="margin-top: 20px;">
        <form action="{{ url_for('feedback') }}" method="GET">
            <button type="submit">
                {% if language == 'english' %}Give Feedback{% elif language == 'hindi' %}‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¶‡•á‡§Ç{% elif language == 'telugu' %}‡∞™‡±ç‡∞∞‡∞§‡∞ø‡∞∏‡±ç‡∞™‡∞Ç‡∞¶‡∞® ‡∞á‡∞µ‡±ç‡∞µ‡∞Ç‡∞°‡∞ø{% elif language == 'kannada' %}‡≤™‡≥ç‡≤∞‡≤§‡≤ø‡≤ï‡≥ç‡≤∞‡≤ø‡≤Ø‡≥Ü ‡≤®‡≥Ä‡≤°‡≤ø{% endif %}
            </button>
        </form>
    </div>
    {% endif %}
</div>

<script>
function startVoiceInput() {
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "{{ 'en-IN' if language == 'english' else 'hi-IN' if language == 'hindi' else 'te-IN' if language == 'telugu' else 'kn-IN' }}";
    recognition.start();
    recognition.onresult = function(event) {
        document.getElementById('chat-input').value = event.results[0][0].transcript;
    };
}

function speakResponse(text) {
    const synth = window.speechSynthesis;
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "{{ 'en-IN' if language == 'english' else 'hi-IN' if language == 'hindi' else 'te-IN' if language == 'telugu' else 'kn-IN' }}";
    synth.speak(utter);
}
</script>
{% endblock %}
